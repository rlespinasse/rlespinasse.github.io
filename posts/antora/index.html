<!doctype html><html><head lang=en>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge"><title>Antora 1.0 | Remplacer votre wiki par un site de documentation - Romain Lespinasse</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="Decouverte d'Antora comme votre prochain site de documentation.">
<meta property="og:image" content>
<meta property="og:title" content="Antora 1.0 | Remplacer votre wiki par un site de documentation">
<meta property="og:description" content="Decouverte d'Antora comme votre prochain site de documentation.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://www.romainlespinasse.dev/posts/antora/"><meta property="og:image" content="https://www.romainlespinasse.dev/img/posts/antora/featured.jpg"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2018-04-18T10:42:00+02:00">
<meta property="article:modified_time" content="2018-04-18T10:42:00+02:00">
<meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://www.romainlespinasse.dev/img/posts/antora/featured.jpg">
<meta name=twitter:title content="Antora 1.0 | Remplacer votre wiki par un site de documentation">
<meta name=twitter:description content="Decouverte d'Antora comme votre prochain site de documentation.">
<script src=https://www.romainlespinasse.dev/js/feather.min.js></script>
<link href=https://www.romainlespinasse.dev/css/fonts.2c2227b81b1970a03e760aa2e6121cd01f87c88586803cbb282aa224720a765f.css rel=stylesheet>
<link rel=stylesheet type=text/css media=screen href=https://www.romainlespinasse.dev/css/main.ac08a4c9714baa859217f92f051deb58df2938ec352b506df655005dcaf98cc0.css>
<link id=darkModeStyle rel=stylesheet type=text/css href=https://www.romainlespinasse.dev/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css disabled>
<script type=text/javascript src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script type=text/x-mathjax-config>
		MathJax.Hub.Config({
			tex2jax: {
				inlineMath: [['$','$'], ['\\(','\\)']],
				displayMath: [['$$','$$'], ['\[','\]']],
				processEscapes: true,
				processEnvironments: true,
				skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
				TeX: { equationNumbers: { autoNumber: "AMS" },
						 extensions: ["AMSmath.js", "AMSsymbols.js"] }
			}
		});
		</script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}]})})</script>
</head>
<body>
<div class=content><header>
<div class=main>
<a href=https://www.romainlespinasse.dev/>Romain Lespinasse</a>
</div>
<nav>
<a href=/>Home</a>
<a href=/posts/>Posts</a>
<a href=/oss/>OSS</a>
<a href=/about/>About</a>
<a href=/tags/>Tags</a>
| <span id=dark-mode-toggle onclick=toggleTheme()></span>
<script src=https://www.romainlespinasse.dev/js/themetoggle.js></script>
</nav>
</header>
<main>
<article>
<div class=title>
<h1 class=title>Antora 1.0 | Remplacer votre wiki par un site de documentation</h1>
<div class=meta>Posted on Apr 18, 2018</div>
</div>
<section class=body>
<blockquote>
<p>Hi, the english version of this article can be read <a href=/posts/antora-en/>on this site</a></p>
</blockquote>
<p>Peu importe votre projet informatique, il y aura toujours un besoin de stocker de la documentation.
Le choix d&rsquo;utiliser un <a href=https://fr.wikipedia.org/wiki/Wiki>wiki</a> est assez courant en entreprise.</p>
<p>Parlons de vous, développeur sur un de ces programmes, la documentation des différents projets est-elle gérée par un wiki facilement accessible et éditable?</p>
<p>Et si vous regardez le contenu de ce wiki, vous y trouverez surement :</p>
<ul>
<li>Des pages avec des sections <code>à documenter</code>,</li>
<li>Des pages avec des informations erronées,</li>
<li>Des pages dépréciées,</li>
<li>Des pages uniquement utiles pour une équipe ou une autre,</li>
<li>Des pages avec de la documentation sur une future évolution.</li>
</ul>
<p>Vous vous demandez donc comment faire pour faciliter la tâche des personnes travaillant sur les différents projets.</p>
<p>À ce moment là, le principe de la <code>documentation as code</code> vous paraît être la solution à votre besoin.</p>
<h2 id=vous-vous-lancez-dans-laventure-de-la-documentation-as-code>Vous vous lancez dans l&rsquo;aventure de la documentation as code</h2>
<p>Voir la documentation comme du code au même titre que les sources du programme est intéressant.
Vous souhaitez remplacer votre wiki actuel par un projet dédié à la documentation, et vous permettre de faire des <code>code review</code> sur ces changements.
Mais cela ne corrige qu&rsquo;une partie du problème, vous avez seulement remplacé des pages wiki par des fichiers écrits dans un autre format comme :</p>
<ul>
<li>le format <a href=https://daringfireball.net/projects/markdown/syntax>Markdown</a>,</li>
<li>le format <a href=http://www.methods.co.nz/asciidoc/>Asciidoc</a>.</li>
</ul>
<p>Du fait de sa syntaxe simple et accessible, le format <code>Markdown</code> est un des plus répandu, surtout sur des sites comme github ou gitlab. Mais le format est trop simple pour une documentation plus approfondie.</p>
<p>Le format <code>Asciidoc</code> est <a href=https://github.com/asciidoctor/asciidoctor.org/blob/master/docs/_includes/asciidoc-vs-markdown.adoc>plus intéressant</a>, il permet d&rsquo;être plus expressif dans votre documentation.
L&rsquo;outil associé <a href=https://asciidoctor.org/>Asciidoctor</a> apporte des <a href=https://asciidoctor.org/docs/asciidoc-writers-guide/>fonctionnalités utiles</a> ainsi que des intégrations comme la génération de diagrammes avec <a href=http://plantuml.com/>plantuml</a>.</p>
<p>Vous choisissez donc d&rsquo;écrire la documentation en <strong>Asciidoctor</strong> dans chacun des projets.
Cela vous permet de livrer la documentation à jour en même temps que le code associé.</p>
<p>Même si votre programme se compose d&rsquo;un ensemble de projets avec chacun sa documentation, vous souhaitez garder un site unique pour y accèder.</p>
<p>Les personnes derrière Asciidoctor ont récemment ouvert, à la communauté open-source, un générateur de site de documentations aggrégées: <a href=https://antora.org/>Antora</a> en version stable (<code>1.0.0</code>).</p>
<p><img src=/img/posts/antora/site.png alt=Antora></p>
<h2 id=vous-créez-votre-nouveau-site-de-documentation-avec-antora--asciidoctor>Vous créez votre nouveau site de documentation avec Antora / Asciidoctor</h2>
<p>Un site généré par Antora est <a href=https://docs.antora.org>composé de trois éléments</a> :</p>
<ul>
<li>Vos projets qui contiennent leurs documentations,</li>
<li>Le <a href=https://docs.antora.org/antora/1.0/playbook/><strong>playbook</strong></a> qui configure la génération du site de documentation,</li>
<li>Une <a href=https://docs.antora.org/antora/1.0/playbook/configure-ui/><strong>UI</strong></a> qui définit le visuel de votre site (celle par défaut conviendra).</li>
</ul>
<p>Pour être utilisé par Antora, un projet se doit de respecter une <a href=https://docs.antora.org/antora/1.0/component-structure/>structure de fichiers</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>./docs
├── antora.yml
└── modules
    └── ROOT
        ├── _attributes.adoc
        ├── nav.adoc
        └── pages
            ├── _attributes.adoc
            └── index.adoc
</code></pre></div><h3 id=vous-mettez-en-place-la-documentation-as-code-sur-vos-projets>Vous mettez en place la documentation as code sur vos projets</h3>
<p>Vous vous appliquez donc à le mettre en place sur :</p>
<ul>
<li>Vos APIs (<a href=https://github.com/rlespinasse/api-a>api A</a>, <a href=https://github.com/rlespinasse/api-b>api B</a>, <a href=https://github.com/rlespinasse/api-c>api C</a>),</li>
<li>Vos outils (<a href=https://github.com/rlespinasse/buildtools>build tools</a>),</li>
<li>Votre guide de development (<a href=https://github.com/rlespinasse/guidelines>guidelines</a>).</li>
</ul>
<p>La documentation au format <code>Asciidoctor</code> est disponible dans le dossier <code>docs</code>.</p>
<blockquote>
<p>Il n&rsquo;est pas nécessaire d&rsquo;utiliser cette arborescence pour <code>guideline</code>, qui est uniquement un projet de documentation.</p>
</blockquote>
<h3 id=vous-vous-préparez-à-générer-votre-site-de-documentation>Vous vous préparez à générer votre site de documentation</h3>
<p>Vous créez donc un <a href=https://github.com/rlespinasse/docssite>projet spécifique</a> pour stocker le <strong>playbook</strong>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>site</span>:
  <span style=color:#f92672>title</span>: <span style=color:#e6db74>&#34;Romain Lespinasse // Docs&#34;</span>
  <span style=color:#f92672>start_page</span>: <span style=color:#ae81ff>guidelines::index</span>
  <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://rlespinasse.github.io/docssite</span>
<span style=color:#f92672>content</span>:
  <span style=color:#f92672>sources</span>:
  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://github.com/rlespinasse/api-a.git</span>
    <span style=color:#f92672>branches</span>: <span style=color:#ae81ff>master</span>
    <span style=color:#f92672>tags</span>: <span style=color:#ae81ff>v*</span>
    <span style=color:#f92672>start_path</span>: <span style=color:#ae81ff>docs</span>
  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://github.com/rlespinasse/api-b.git</span>
    <span style=color:#f92672>branches</span>: <span style=color:#ae81ff>master</span>
    <span style=color:#f92672>tags</span>: <span style=color:#ae81ff>v*</span>
    <span style=color:#f92672>start_path</span>: <span style=color:#ae81ff>docs</span>
  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://github.com/rlespinasse/api-c.git</span>
    <span style=color:#f92672>branches</span>: <span style=color:#ae81ff>master</span>
    <span style=color:#f92672>tags</span>: <span style=color:#ae81ff>v*</span>
    <span style=color:#f92672>start_path</span>: <span style=color:#ae81ff>docs</span>
  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://github.com/rlespinasse/buildtools.git</span>
    <span style=color:#f92672>branches</span>: <span style=color:#ae81ff>master</span>
    <span style=color:#f92672>tags</span>: <span style=color:#ae81ff>v*</span>
    <span style=color:#f92672>start_path</span>: <span style=color:#ae81ff>docs</span>
  - <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://github.com/rlespinasse/guidelines.git</span>
    <span style=color:#f92672>branches</span>: <span style=color:#ae81ff>master</span>
<span style=color:#f92672>ui</span>:
  <span style=color:#f92672>bundle</span>:
    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>https://gitlab.com/antora/antora-ui-default/-/jobs/artifacts/master/raw/build/ui-bundle.zip?job=bundle-stable</span>
    <span style=color:#f92672>snapshot</span>: <span style=color:#66d9ef>true</span>
  <span style=color:#f92672>output_dir</span>: <span style=color:#ae81ff>ui-bundle</span>
  <span style=color:#f92672>supplemental_files</span>: <span style=color:#ae81ff>./supplemental-ui</span>
<span style=color:#f92672>output</span>:
  <span style=color:#f92672>dir</span>: <span style=color:#ae81ff>./docs</span>
</code></pre></div><p>Le contenu du <a href=https://docs.antora.org/antora/1.0/playbook/playbook/>playbook</a> <code>site.yml</code> définit :</p>
<ul>
<li>les <a href=https://docs.antora.org/antora/1.0/playbook/configure-site/>informations relatives</a> au site en lui-même via <code>site:</code>,</li>
<li>la définition du <a href=https://docs.antora.org/antora/1.0/playbook/configure-content-sources/>contenu</a> via <code>content:</code>,</li>
<li>le <a href=https://docs.antora.org/antora/1.0/playbook/configure-ui/>theme du site</a> via <code>ui:</code>,</li>
<li>Le <a href=https://docs.antora.org/antora/1.0/playbook/configure-output/>dossier de génération</a> via <code>output:</code>.</li>
</ul>
<p>La documentation officielle n&rsquo;en fait pas référence, car il s&rsquo;agit d&rsquo;un <a href=https://gitlab.com/antora/antora/issues/147>dévelopement encore au stade expérimental</a> mais vous configurez la barre de navigation pour rajouter les liens utiles via un fichier <code>header-content.hbs</code> dans <code>supplemental-ui/partials/</code>.</p>
<blockquote>
<p>D&rsquo;autres fichiers templates sont disponibles pour remplacement dans <a href=https://gitlab.com/antora/antora-ui-default/tree/master/src/partials>Antora Default UI</a>.</p>
</blockquote>
<h2 id=vous-générez-et-déployez-votre-nouveau-site-de-documentation>Vous générez et déployez votre nouveau site de documentation</h2>
<p>Vous pouvez installer antora via ce <a href=https://docs.antora.org/antora/1.0/install/install-antora/>guide</a> ou utiliser l&rsquo;image docker via la commande <code>docker run -v `pwd`:/antora --rm antora/antora --stacktrace site.yml</code> (où <strong>site.yml</strong> est le playbook)</p>
<p>Le playbook défini le dossier <code>docs</code> pour mettre à disposition votre nouveau site de documentation.</p>
<p><img src=/img/posts/antora/site-preview.png alt="Site preview"></p>
<p>Par exemple, pour le rendre accessible sur Github, vous le déployez via les Github Pages de votre projet <code>docssite</code>.</p>
<p><img src=/img/posts/antora/github.png alt="Github document configuration"></p>
<p>La plateforme s&rsquo;occupera automatiquement d&rsquo;exposer le contenu du dossier <code>/docs</code> à l&rsquo;adresse <a href=https://rlespinasse.github.io/docssite>https://rlespinasse.github.io/docssite</a>.</p>
<h2 id=vous-faites-profitez-aux-autres-du-nouveau-site-de-documentation>Vous faites profitez aux autres du nouveau site de documentation</h2>
<p>Dorénavant, les personnes, travaillant sur le programme, pourront ajouter, créer, maintenir de la documentation relative à chacun des projets très facilement. Votre nouveau site de documentation permettant d&rsquo;accèder à toutes ces pages.</p>
<p>Le site <a href=https://docs.antora.org>docs.antora.org</a> utilise lui-même le projet <code>Antora</code>.</p>
<blockquote>
<p>Merci à <a href=https://twitter.com/sn0rks>Aurélien Allienne</a>, <a href=https://twitter.com/AMeausoone>Antoine Méausoone</a>, <a href=https://twitter.com/hsablonniere>Hubert Sablonnière</a>, <a href=https://twitter.com/TanguyBAUDRIN>Tanguy Baudrin</a>, et <a href=https://twitter.com/chezTone>Tony Proum</a> pour la relecture de l&rsquo;article.</p>
</blockquote>
<p>Cet article a été publié en premier sur <a href=https://sfeir.com>lemag.sfeir.com</a>.</p>
</section>
<div class=post-tags>
<nav class="nav tags">
<ul class=tags>
<li><a href=/tags/antora>antora</a></li>
<li><a href=/tags/asciidoctor>asciidoctor</a></li>
<li><a href=/tags/french>french</a></li>
</ul>
</nav>
</div>
</article>
</main>
<footer>
<div style=display:flex><a class=soc href=https://github.com/rlespinasse rel=me title=GitHub><i data-feather=github></i></a>
<a class=border></a><a class=soc href=https://www.linkedin.com/in/romain-lespinasse rel=me title=LinkedIn><i data-feather=linkedin></i></a>
<a class=border></a><a class=soc href=https://bsky.app/profile/rlespinasse.bsky.social rel=me title=Bluesky><i data-feather=cloud></i></a>
<a class=border></a></div>
<div class=footer-info>
2024 © Romain Lespinasse | <a href=https://github.com/athul/archie>Archie Theme</a> | Built with <a href=https://gohugo.io>Hugo</a>
</div>
</footer>
<script>feather.replace()</script></div>
</body>
</html>